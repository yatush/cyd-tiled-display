esp32:
  board: esp32dev
  framework:
    type: esp-idf

spi:
  - id: tft
    clk_pin: GPIO14
    mosi_pin: GPIO13
    miso_pin: GPIO12
  - id: touch
    clk_pin: GPIO25
    mosi_pin: GPIO32
    miso_pin: GPIO39

output:
  - platform: ledc
    pin: GPIO21
    id: backlight_pwm
  - platform: ledc
    id: output_red
    pin: GPIO4
    inverted: true
  - platform: ledc
    id: output_green
    pin: GPIO16
    inverted: true
  - platform: ledc
    id: output_blue
    pin: GPIO17
    inverted: true

uart:
  tx_pin: GPIO22
  rx_pin: GPIO27
  baud_rate: 256000
  parity: NONE
  stop_bits: 1

sensor:
  - platform: adc
    pin: GPIO34
    id: board_ldr
    name: "board_ldr"
    update_interval: 1000ms
    entity_category: "diagnostic"
    accuracy_decimals: 3
    internal: true
    filters:
      - delta: 0.01

globals:
  - id: render_diffs
    type: bool
    initial_value: "true"
  - id: width
    type: int
    initial_value: "320"
  - id: height
    type: int
    initial_value: "240"
  - id: tile_border_width
    type: int
    initial_value: "1"

font:
  # Master glyph list - define ALL Material Icons glyphs once
  - file: "gfonts://Material+Symbols+Outlined"
    id: tiny
    size: 24
    glyphs: !include mdi_glyphs.yaml

  - file: "gfonts://Material+Symbols+Outlined"
    id: small
    size: 40
    glyphs: !include mdi_glyphs.yaml

  - file: "gfonts://Material+Symbols+Outlined"
    id: medium
    size: 60
    glyphs: !include mdi_glyphs.yaml

  - file: "gfonts://Material+Symbols+Outlined"
    id: big
    size: 80
    glyphs: !include mdi_glyphs.yaml

  - file: "gfonts://Roboto"
    id: text_regular
    size: 20

  - file: "gfonts://Roboto@900"
    id: text_bold
    size: 20

  - file: "gfonts://Roboto@900"
    id: text_big_bold
    size: 30

  - file: "gfonts://Roboto@900"
    id: text_small
    size: 12
    glyphs: !include roboto_glyphs.yaml

display:
  - platform: ili9xxx
    update_interval: 10s
    model: ili9341
    spi_id: tft
    color_palette: 8BIT
    cs_pin: GPIO15
    dc_pin: GPIO2
    id: disp
    transform: { mirror_y: true }
    dimensions:
      width: 320
      height: 240
    invert_colors: false
    color_order: BGR


touchscreen:
  id: touchscreen_id
  platform: xpt2046
  spi_id: touch
  cs_pin: GPIO33
  threshold: 400
  calibration: { x_min: 360, x_max: 3780, y_min: 320, y_max: 3800 }
  transform:
    swap_xy: true
  on_touch:
    then:
      - script.execute:
          id: _handle_touch
          x: !lambda return touch.x;
          y: !lambda return touch.y;
          x_raw: !lambda return touch.x_raw;
          y_raw: !lambda return touch.y_raw;
